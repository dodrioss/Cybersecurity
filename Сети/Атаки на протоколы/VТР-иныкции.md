VLAN Trunk Protocol (VTP).

VTP-пакеты передаются только по **транковым** (trunk) портам и содержат:

- Имя домена VTP
- **Revision number** (номер ревизии) — очень важный параметр
- Список VLAN (добавление/удаление/переименование)

Правила синхронизации в VTP:

- Коммутатор с **более высоким revision number** перезаписывает базу VLAN на всех остальных устройствах в домене (server → client, или даже server → server).
- Если revision выше — принимается обновление **без вопросов**.

Ключевая суть тут в том, что мы должны закинуть наш пакет с более высоким Revision number, тогда и в иерархии он будет выше.

### Основные типы VTP-инъекций

1. **VTP Delete Attack** (самая разрушительная, DoS)
    - Атакующий отправляет VTP Update с revision number выше текущего и пустой/минимальной базой VLAN.
    - Результат: **все VLAN удаляются** на всех коммутаторах в домене → сеть парализуется (серверы, клиенты, VoIP-телефоны и т.д. теряют связь).
    - Инструмент: **Yersinia** (режим VTP → "VTP inject → Erase database")
2. **VTP Add/Modify Attack**
    - Добавление/изменение VLAN (например, создание VLAN с именем "HACKED" или перенос портов в другой VLAN).
    - Менее разрушительно, но позволяет обходить сегментацию.
3. **VTP Domain Injection** (вместе с DTP)
    - Сначала атакующий заставляет порт стать trunk (DTP spoofing / DTP injection).
    - Затем отправляет VTP-пакт с нужным доменом и высоким revision → захватывает управление VLAN-базой.

### Что нужно для успешной атаки

- Доступ к порту, который может стать trunk (часто dynamic desirable/auto — уязвимо по умолчанию).
- Или уже trunk-порт (например, после DTP-атаки).
- Знание имени VTP-домена (можно узнать из CDP, утечек, brute-force или просто угадать — часто "default", "cisco", имя компании).

